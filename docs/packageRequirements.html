<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>HADES Package Requirements</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />
<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><img src="images/hadesMini.png" width = 80 height = 17/></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="packages.html">
    <span class="fa fa-cube"></span>
     
    Packages
  </a>
</li>
<li>
  <a href="validation.html">
    <span class="fa fa-clipboard-check"></span>
     
    Validation
  </a>
</li>
<li>
  <a href="publications.html">
    <span class="fa fa-pen-alt"></span>
     
    Publications
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-life-ring"></span>
     
    Support
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="support.html">Questions and Bug reports</a>
    </li>
    <li>
      <a href="rSetup.html">R setup</a>
    </li>
    <li>
      <a href="installingHades.html">Installing HADES</a>
    </li>
    <li>
      <a href="connecting.html">Connecting to a Database</a>
    </li>
    <li>
      <a href="supportedPlatforms.html">Supported Database Platforms</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-flask"></span>
     
    Study packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="renv.html">Using Renv for Dependencies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-wrench"></span>
     
    Developers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="contribute.html">How to contribute</a>
    </li>
    <li>
      <a href="community.html">Developer Community</a>
    </li>
    <li>
      <a href="developerGuidelines.html">Developer Guidelines</a>
    </li>
    <li>
      <a href="codeStyle.html">Code Style</a>
    </li>
    <li>
      <a href="releaseProcess.html">Release Process</a>
    </li>
    <li>
      <a href="packageStatuses.html">Package Statuses</a>
    </li>
    <li>
      <a href="developmentRoadmap.html">Development Roadmap</a>
    </li>
    <li>
      <a href="packageRequirements.html">HADES Package Requirements</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">HADES Package Requirements</h1>

</div>


<p>This page describes the minimal requirements a package must meet to
be considered for inclusion in HADES.</p>
<div id="functionality" class="section level1">
<h1>Functionality</h1>
<div id="implement-ohdsi-best-practices" class="section level2">
<h2>Implement OHDSI best practices</h2>
<p>A HADES package should implement OHDSI best practices, ideally as
established through systematic emprical evaluation. Best practices
include the ability to apply methods at large scale (e.g. across many
exposures and outcomes). Methods should provide diagnostics, allowing
the user to verify wether the results are accurate. (E.g. computing the
standardized difference of the mean after propensity score
matching).</p>
</div>
<div id="minimize-duplication-of-functionality" class="section level2">
<h2>Minimize duplication of functionality</h2>
<p>There should be no two HADES packages that provide the same
functionality. For example, all communication with <code>WebAPI</code>
should go through <code>ROhdsiWebApi</code>, all comparative cohort
analytics should go in the <code>CohortMethod</code> package, etc.</p>
</div>
</div>
<div id="cross-platform-support" class="section level1">
<h1>Cross-platform support</h1>
<div id="cross-database-platform-support" class="section level2">
<h2>Cross-database-platform support</h2>
<p>When a package needs to communicate with a user’s database server,
the package must support a wide variety of database platforms. The main
mechanisms for this in HADES are the <code>DatabaseConnector</code> and
<code>SqlRender</code> packages.</p>
</div>
<div id="cross-operating-system" class="section level2">
<h2>Cross-operating system</h2>
<p>A HADES package should run without problems on Microsoft Windows,
MacOS, and Linux.</p>
</div>
</div>
<div id="code-style-and-organization" class="section level1">
<h1>Code style and organization</h1>
<p>All HADES R package follow the basic structure of R packages. See <a
href="http://r-pkgs.had.co.nz/">R packages</a> for a thorough discussion
on R packages.</p>
<div id="extras-folder" class="section level2">
<h2>Extras folder</h2>
<p>The <code>extras</code> folder contains all files used by the package
developer. These files will not be part of the package once installed. A
required file in this folder is <code>PackageMaintenance.R</code>, which
contains the code executed when releasing a package.</p>
</div>
<div id="versioning" class="section level2">
<h2>Versioning</h2>
<p>Each package has a three-digit version number.</p>
<ul>
<li><p>New micro versions (e.g. from 4.3.2 to 4.3.3) indicate bug fixes
only. No new functionality, and forward and backward compatibility are
guaranteed</p></li>
<li><p>New minor versions (e.g. from 4.3.3 to 4.4.0) indicate added
functionality. Only backward compatibility is guaranteed</p></li>
<li><p>New major versions (e.g. from 4.4.0 to 5.0.0) indicate major
revisions. All bets are off in terms of compatibility</p></li>
</ul>
</div>
<div id="branches-and-tags" class="section level2">
<h2>Branches and tags</h2>
<p>The ‘main’ branch at all times should contain the latest released
version. Each version, including the latest release, should be tagged as
‘vx.x.x’, for example ‘v1.0.0’.</p>
<p>It is highly recommended to keep the latest develop version in a
branch called ‘develop’.</p>
</div>
<div id="code-style" class="section level2">
<h2>Code style</h2>
<p>A HADES package should adhere to the <a href="codeStyle.html">HADES
codes style guide</a>.</p>
</div>
<div id="copyright-header" class="section level2">
<h2>Copyright header</h2>
<p>In each source file should start with a copyright header like
this:</p>
<pre><code># Copyright 2022 Observational Health Data Sciences and Informatics
#
# This file is part of CohortMethod
#
# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.</code></pre>
</div>
<div id="packages-must-not-have-invisible-side-effects"
class="section level2">
<h2>Packages must not have invisible side effects</h2>
<p>When a user calls a function, the effect of that call should be
aparent to the user. This means:</p>
<ul>
<li><p>Do not call <code>library</code> or <code>require</code> in a
function, as this changes the user’s search path.</p></li>
<li><p>Do not set options.</p></li>
<li><p>Do not write to files other than those specified by the user in
the function call.</p></li>
<li><p>Do not use global variables.</p></li>
</ul>
<p>Intead of using <code>library</code>, always explicitly reference the
packge a function belongs to, for example
<code>SqlRender::translate()</code>.</p>
</div>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>All HADES packages should licensed as Apache 2.0.</p>
</div>
<div id="documentation" class="section level1">
<h1>Documentation</h1>
<div id="function-documentation" class="section level2">
<h2>Function documentation</h2>
<p>The <code>roxygen2</code> package should be used for function
documentation. Each function and function argument must be
documented.</p>
</div>
<div id="vignettes" class="section level2">
<h2>Vignettes</h2>
<p>Vignettes are highly recommended as a way to explain how the package
can be used for one or more typical use cases.</p>
</div>
<div id="readme.md-and-website" class="section level2">
<h2>README.md and website</h2>
<p>The README.md and package website should follow HADES style and
organization. The package website should be generated using the
<code>pkgdown</code> package. See any HADES package for examples.</p>
</div>
<div id="news.md" class="section level2">
<h2>NEWS.md</h2>
<p>Changes should be maintained in NEWS.md. This should be aimed at the
user, to explain what has changed from the user’s perspective. Avoid
referencing GitHub issues, which are aimed at developers.</p>
</div>
<div id="announce-new-releases-on-the-ohdsi-forums"
class="section level2">
<h2>Announce new releases on the OHDSI forums</h2>
<p>Each release should be announced in the OHDSI Forums, in <a
href="https://forums.ohdsi.org/t/hades-development-announcements/12293">this
thread</a>. Provide a link to the change log, and briefly described the
most important changes.</p>
</div>
</div>
<div id="continuous-integration-and-unit-test" class="section level1">
<h1>Continuous integration and unit test</h1>
<p>Use the OHDSI GitHub Actions for continuous integration, so R check
is performed at every push to the repo. Released packages must pass R
without warnings on Windows, MacOS, and Linux. Tagging the released
version should be done automatically, as described in the <a
href="releaseProcess.html">release process</a>.</p>
<div id="unit-tests" class="section level2">
<h2>Unit tests</h2>
<p>OHDSI unit testing for R follows the standard R practice using
<code>test_that</code>: A folder named ‘tests’ is created in the root of
the package, and this folder contains</p>
<ul>
<li>A sub-folder called ’testthat`</li>
<li>A file called ‘testthat.R’</li>
<li>The file ‘testthat.R’ should have the following content:</li>
</ul>
<pre class="r"><code>library(testthat)
library(&lt;package name&gt;)
test_check(&quot;&lt;package name&gt;&quot;)</code></pre>
<p>The sub-folder ‘testthat’ should contain one or more R scripts whose
file name starts with ‘test-’ (e.g. ‘test-connection.R’. Each file
should contain one or more <code>test_that</code> blocks, for
example</p>
<pre class="r"><code>test_that(&quot;Function x returns 2&quot;, {
  expect_equal(x(), 2)
})</code></pre>
<p>Each package should have unit tests. Unit test coverage must be
around 80%.</p>
</div>
</div>
<div id="dependencies" class="section level1">
<h1>Dependencies</h1>
<div id="hades-or-cran" class="section level2">
<h2>HADES or CRAN</h2>
<p>A HADES package may only depend on other HADES packages or packages
in CRAN. HADES dependencies not in CRAN should be in
<code>Remotes</code> section of the DESCRIPTION file.</p>
</div>
<div id="minimize-overall-dependencies" class="section level2">
<h2>Minimize overall dependencies</h2>
<p>Dependencies lead to instability. Only add dependencies to other
packages if completely unavoidable. We have more or less accepted we
need to depend on the <em>core</em> <a
href="https://www.tidyverse.org/"><code>tidyverse</code></a> packages,
so any of those packages are allowed.</p>
</div>
<div id="minimize-added-dependencies" class="section level2">
<h2>Minimize added dependencies</h2>
<p>Where possible, only use packages that are already used by other
HADES packages. For example, when storing objects too large to fit in
memory, use <code>Andromeda</code>, not <code>ff</code>. Similarly,
avoid adding a new technology; HADES packages primarily use R, C++
(embedded in R packages), Java (through rJava), and some Python (through
<code>reticulate</code>). Avoid requiring for example Julia or .Net.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
